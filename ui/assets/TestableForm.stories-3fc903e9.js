var N=Object.defineProperty;var A=(e,t,s)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var a=(e,t)=>N(e,"name",{value:t,configurable:!0});var u=(e,t,s)=>(A(e,typeof t!="symbol"?t+"":t,s),s);import{j as c}from"./jsx-runtime-91e341d4.js";import{B as O}from"./Button-6cc3cb4d.js";import{u as D,F as T}from"./index.esm-5977a1bd.js";import{p as h,c as k,a as S,r as Z,e as U,h as Y,I as y}from"./InputWrapper-29c446b8.js";import{T as _}from"./TextInput-7432ede3.js";import{P as J}from"./PasswordInput-8e54b3b1.js";import{S as W}from"./SelectInput-c2051636.js";import{C as z}from"./Checkbox-c0edb7bf.js";import"./ValidationHint-65b7e2de.js";import{u as G}from"./styled-components.browser.esm-dd68fb2f.js";import{r as K}from"./index-b56a0300.js";import"./index-8d138fa4.js";import"./Icon.hoc-787425e7.js";import"./Icon.constants-f71a83c2.js";import"./Symbols.hoc-d0e330fb.js";import"./index-17b0cd16.js";import"./index-6925154b.js";import"./Button.constants-c6e6f0a7.js";import"./devices-1d39230d.js";import"./breakPoints-89c7d41a.js";import"./launch-outline-16-2a071c4c.js";import"./warning-solid-24-62e98cc2.js";import"./LoadingEllipsis-859301b8.js";import"./IconButton-dda0da21.js";import"./eye-visible-solid-24-51ef0235.js";import"./chevron-down-solid-16-ecd33624.js";import"./tick-solid-16-20e5c3c2.js";import"./tick-solid-32-8cd2f25a.js";import"./ScreenReaderOnly-61d613bc.js";import"./mixins-0d98ffaa.js";import"./tick-round-solid-12-8c368b0e.js";import"./_commonjsHelpers-c38d1a10.js";const x=a(({children:e,...t})=>{const r=a(i=>{i.preventDefault()},"preventSubmission");return c.jsx("form",{noValidate:!0,onSubmit:r,...t,children:e})},"Form$1");try{x.displayName="Form",x.__docgenInfo={description:"",displayName:"Form",props:{}}}catch{}const l=a(({type:e,condition:t,message:s,messageBuilder:r})=>t?null:{type:e,message:s,messageBuilder:r},"handler"),Q=a(()=>({validate:e=>{const s=typeof h(e)=="string";return l({type:"isString",condition:s,message:"Field must be text only",messageBuilder:r=>`${r} must be text only`})}}),"isString"),X=a(()=>({validate:e=>{const t=!isNaN(e);return l({type:"isNumber",condition:t,message:"Field must be a number",messageBuilder:s=>`${s} must be a number`})}}),"isNumber"),C=a(()=>({validate:e=>l({type:"isBoolean",condition:typeof e=="boolean",message:"Field must be true or false",messageBuilder:s=>`${s} must be true or false`})}),"isBoolean"),L=a((e="string")=>({validate:t=>{if(e==="boolean")return C().validate(t,{});const r=h(t).length>0;return l({type:"required",condition:r,message:"Field is required",messageBuilder:i=>`${i} is required`})}}),"isNotEmpty"),tt=a(()=>({validate:e=>{const t=h(e),r=new RegExp(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i).test(t);return l({type:"isEmail",condition:r,message:"Please enter a valid email address",messageBuilder:()=>"Please enter a valid email address"})}}),"isEmail"),et=a(e=>({validate:(t,s)=>{const i=h(t)===s[e];return l({type:"doesMatch",condition:i,message:"Fields must match",messageBuilder:n=>`${n} fields must match`})}}),"doesMatch"),st=a((e,t)=>({validate:s=>{const r=h(s),i=k(r,t),n={type:`hasMin${S(t||"")}`,condition:i>=e};return l(t?{...n,message:`Must contain minimum ${e} ${t}`,messageBuilder:()=>`Must contain minimum ${e} ${t}`}:{...n,message:`Minimum length is ${e} characters`,messageBuilder:()=>`Minimum length is ${e} characters`})}}),"hasMin"),rt=a((e,t)=>({validate:s=>{const r=h(s),i=k(r,t),n={type:`hasMax${S(t||"")}`,condition:i<=e};return l(t?{...n,message:`Must contain maximum ${e} ${t}`,messageBuilder:()=>`Must contain maximum ${e} ${t}`}:{...n,message:`Maximum length is ${e} characters`,messageBuilder:()=>`Maximum length is ${e} characters`})}}),"hasMax"),it=a((e,t,s)=>({validate:r=>{const i=Number(r),n={type:`hasRange${S(s||"")}`,condition:i>=e&&i<=t};return l(s?{...n,message:`Must contain a minimum value of ${e} ${s} and a maximum value of ${t} ${s}`,messageBuilder:()=>`Must contain a minimum value of ${e} ${s} and a maximum value of ${t} ${s}`}:{...n,message:`Minimum value is ${e} characters and maximum value is ${t} characters`,messageBuilder:()=>`Minimum value is ${e} characters and maximum value is ${t} characters`})}}),"hasRange"),at=a(()=>({validate:e=>{const s={type:"containsNoSpaces",condition:!h(e).includes(" ")};return l({...s,message:"Must not contain any spaces",messageBuilder:()=>"Must not contain any spaces"})}}),"containsNoSpaces"),ot=a(e=>({validate:t=>{const s=h(t),r={type:"matchesRegex",condition:e.test(s)};return l({...r,message:"Field does not match the required format",messageBuilder:()=>"Field does not match the required format"})}}),"matchesRegex"),nt=a(e=>({validate:async t=>{const s=h(t),r={type:"hasCustomValidation",condition:await(async()=>{try{return await e(s)}catch{return!1}})()};return l({...r,message:"Field does not pass the custom validation",messageBuilder:()=>"Field does not pass the custom validation"})}}),"hasCustomValidation"),V=[];class P{constructor(t){u(this,"name");u(this,"primitiveType","string");u(this,"isRequired",!1);u(this,"validators",[]);this.name=t}initialise(t,s){this.primitiveType=t,this.validators=s}checkValid(){if(!this.validators.length)throw new Error("No validators set")}string(){return this.initialise("string",[[Q,V]]),this}number(){return this.initialise("number",[[X,V]]),this}boolean(){return this.initialise("boolean",[[C,V]]),this}required(){return this.isRequired=!0,this}isEmail(...t){return this.checkValid(),this.validators.push([tt,t]),this}doesMatch(...t){return this.checkValid(),this.validators.push([et,t]),this}hasMin(...t){return this.checkValid(),this.validators.push([st,t]),this}hasMax(...t){return this.checkValid(),this.validators.push([rt,t]),this}hasRange(...t){return this.checkValid(),this.validators.push([it,t]),this}containsNoSpaces(...t){return this.checkValid(),this.validators.push([at,t]),this}matchesRegex(...t){return this.checkValid(),this.validators.push([ot,t]),this}hasCustomValidation(...t){return this.checkValid(),this.validators.push([nt,t]),this}}a(P,"SchemaEntry");class g{constructor(t){u(this,"self");u(this,"fields");u(this,"names");u(this,"errors",{});u(this,"validationHints");return this.self=t,this.fields=Object.keys(t),this.names=Object.entries(t).reduce((s,[r,i])=>({...s,[r]:i.name}),{}),this.validationHints={},this.initValidationHints(),this}static add(t){return new P(t)}get(t){return this.self[t]}getErrors(t){return this.errors[t]}setErrors(t,s){!s||s.length===0?delete this.errors[t]:this.errors[t]=s}getValidationHints(t){return this.validationHints[t]}setValidationHints(t,s,r,i){this.validationHints[t]={...this.validationHints[t],[s]:{passes:r,hint:i}}}initValidationHint(t){this.get(t).validators.forEach(r=>{const[,i]=r,[n,p,f]=i;f&&this.setValidationHints(t,[n,p].join("."),!1,f)})}initValidationHints(){this.fields.forEach(t=>{this.initValidationHint(t)})}resetValidationHints(t){this.validationHints[t]&&Object.keys(this.validationHints[t]).forEach(s=>{this.validationHints[t][s].passes=!1})}async validate(t,s,r){const i=this.get(t);if(!i)return;const n=i.isRequired,p=await L(i.primitiveType).validate(s,r);if(n&&p)return this.setErrors(t,[p]),this.resetValidationHints(t),this.getErrors(t);const M=(await Promise.all(i.validators.map(async b=>{const[w,F]=b,[B,I,o]=F,d=await w(...F).validate(s,r);return o&&this.setValidationHints(t,[B,I].join("."),!d&&s!=="",o),d}))).filter(b=>b);return this.setErrors(t,M),this.getErrors(t)}}a(g,"Schema");const lt=G.div.withConfig({componentId:"sc-1l9mewf-0"})(["width:500px;padding:","px;"],({theme:e})=>e.spacing.x2),dt=a((e,t={})=>{if(!e)throw new Error("No schema provided! Please provide a schema to useIndyForm");const s=D({mode:"onTouched",resolver:Z(e),...t}),{formState:r,getValues:i,setError:n}=s;K.useEffect(()=>{const o=e.fields,m=Object.keys(i()),d=o.filter(v=>!m.includes(v));if(d.length>0)throw new Error(`Fields ["${d.join('", "')}"] are included in the schema but missing or inaccessible by React Hook Form`)},[i,e.fields]);const p=a(o=>{const d=r.errors[o];if(d)return d[0].messageBuilder(e.names[o])},"getTextInputError"),f=a(o=>{const m=!!r.errors.root,d=!!r.errors[o],v=r.dirtyFields[o]&&!d;return d||m?y.ERROR:v?y.SUCCESS:y.DEFAULT},"getTextInputState");return{registerControlledInput:a(o=>{var H;const m=((H=e.get(o))==null?void 0:H.isRequired)||!1,d=p(o),v=f(o);return{id:o,state:v,message:d,required:m,"aria-required":m,"aria-invalid":d==="error","aria-describedby":`${U(o)} ${Y(o)}`}},"registerControlledInput"),methods:{...s,setFormError:a(o=>{n("root",{message:o})},"setFormError"),setFieldError:a((o,m)=>{n(o,{message:m},{shouldFocus:!0})},"setFieldError"),getFormError:a(()=>p("root"),"getFormError"),getFieldErrors:a(()=>e.fields.map(p).filter(Boolean),"getFieldErrors"),getFieldValidationHints:a(o=>e.validationHints[o],"getFieldValidationHints")},formState:{...r,errors:r.errors}}},"useIndyForm"),mt=new g({fullName:g.add("Full name").string(),email:g.add("Email address").string().isEmail().required(),password:g.add("Password").string().hasMin(1,"digits").hasMin(6,"letters").required(),birthYear:g.add("Birth year").number().required(),terms:g.add("Privacy opt in").boolean().required()}),$=a(({onSubmit:e})=>{const{methods:t,registerControlledInput:s}=dt(mt),{handleSubmit:r,formState:i}=t;return c.jsx(lt,{children:c.jsx(T,{...t,children:c.jsxs(x,{children:[c.jsx(_,{label:"Name",...s("fullName")}),c.jsx(_,{type:"email",label:"Email address",helpText:"Add an email address",...s("email")}),c.jsx(J,{label:"Password",helpText:"Make it a good one",...s("password")}),c.jsx(W,{label:"Birth year",options:[{value:"1970",label:"1970"},{value:"1980",label:"1980"},{value:"1990",label:"1990"}],...s("birthYear")}),c.jsx(z,{label:"I accept the terms and conditions",...s("terms")}),c.jsx(O,{type:"submit",disabled:!i.isValid,onClick:r(e),children:"Sign up"})]})})})},"TestableForm"),ut=$;try{$.displayName="TestableForm",$.__docgenInfo={description:`This form exists to demonstrate how to use the useIndyForm hook
alongside the Form, TextInput and PasswordInput components

It us also used for testing functionality in a form context
with full validation and error handling, and providing a
component in storybook for visual testing`,displayName:"TestableForm",props:{onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"SubmitHandler<ExampleFormData>"}}}}}catch{}const ct={onSubmit:e=>alert(`Submitted: ${JSON.stringify(e)}`)},Jt={title:"Modules/Form",component:ut},E={args:ct};var j,q,R;E.parameters={...E.parameters,docs:{...(j=E.parameters)==null?void 0:j.docs,source:{originalSource:`{
  args: defaultArgs
}`,...(R=(q=E.parameters)==null?void 0:q.docs)==null?void 0:R.source}}};const Wt=["Default"];export{E as Default,Wt as __namedExportsOrder,Jt as default};
//# sourceMappingURL=TestableForm.stories-3fc903e9.js.map
